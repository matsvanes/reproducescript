%%

cfg = [];
cfg.dataset = '../rawdata/Subject04.ds';
cfg.trialfun = 'ft_trialfun_general';
cfg.trialdef.eventtype = 'backpanel trigger';
cfg.trialdef.eventvalue = [3 5 9];
cfg.trialdef.prestim = 1;
cfg.trialdef.poststim = 2;

cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg = ft_definetrial(cfg);

%%

cfg = [];
cfg.dataset = '../rawdata/Subject04.ds';
cfg.trialfun = 'ft_trialfun_general';
cfg.trialdef.eventtype = 'backpanel trigger';
cfg.trialdef.eventvalue = [3 5 9];
cfg.trialdef.prestim = 1;
cfg.trialdef.poststim = 2;

cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.datafile = '../rawdata/Subject04.ds/Subject04.meg4';
cfg.headerfile = '../rawdata/Subject04.ds/Subject04.res4';
cfg.dataformat = 'ctf_meg4';
cfg.headerformat = 'ctf_res4';
cfg.representation = 'numeric';
cfg.trl = 'reproduce_Subject04/20210112T114109_ft_preprocessing_largecfginput_trl.mat';
cfg.outputfile = { 'reproduce_Subject04/20210112T114109_ft_preprocessing_output_data.mat' };
cfg.channel = { 'MEG', 'EOG' };
cfg.continuous = 'yes';
ft_preprocessing(cfg);

%%

cfg = [];
cfg.artfctdef.visual.artifact = [21601 22500;
130501 131400;
178201 179100;
14401 15300;
36901 37800;
122401 123300;
126901 127800;
160201 161100;
170101 171000;
189901 190800;
211501 212400;
233101 234000;
235801 236700];


cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114109_ft_preprocessing_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114115_ft_rejectartifact_output_data.mat' };
ft_rejectartifact(cfg);

%%

cfg = [];
cfg.trials = logical([false;
true;
false;
false;
true;
true;
false;
false;
true;
false;
true;
false;
true;
false;
true;
false;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
true;
false;
true;
true;
false;
false;
false;
false;
true;
false;
false;
true;
false;
false;
false;
false;
false;
true;
false;
false;
true;
false;
true;
false;
true;
false;
true;
false;
false;
false;
true;
false;
false;
false;
true;
true;
false;
false;
false;
false;
false;
true;
false;
false;
false;
true;
true;
false;
false;
false;
false;
false;
false;
true;
false;
false;
true;
false;
false;
false;
true;
true;
false;
true;
true;
false;
true;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
false;
true;
false;
false;
true;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
false;
false;
true;
true;
false;
true;
false;
false;
true;
true;
false;
false;
false;
false;
false;
false;
true;
true;
false;
false;
true;
false;
true;
true;
false;
true;
true;
true;
false;
false;
false;
true;
false;
true;
true;
false;
false;
false;
false;
false;
false;
false;
true;
false;
false;
true;
false;
true;
false;
true;
true;
false;
false;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
true;
false;
true;
true;
false;
true;
false;
false;
true;
false;
false;
false;
false;
false;
true;
false;
false;
false;
false;
false;
false;
true;
true;
false;
true;
false;
true;
true;
false;
true;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
false;
true;
false;
false;
true;
false;
false;
false;
true;
false;
false;
false;
true;
false;
false;
true;
false;
false;
true;
true]);
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114115_ft_rejectartifact_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114121_ft_timelockanalysis_output_timelock.mat' };
ft_timelockanalysis(cfg);

%%

cfg = [];
cfg.trials = logical([true;
false;
true;
false;
false;
false;
true;
false;
false;
false;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
false;
true;
true;
false;
false;
true;
false;
false;
false;
false;
true;
true;
true;
false;
false;
false;
false;
false;
true;
true;
true;
false;
true;
false;
false;
true;
false;
false;
false;
false;
false;
true;
false;
false;
false;
true;
false;
false;
true;
true;
false;
false;
true;
true;
true;
false;
false;
false;
false;
true;
true;
false;
false;
true;
true;
false;
false;
false;
false;
false;
false;
true;
false;
true;
true;
false;
false;
false;
true;
false;
false;
true;
false;
false;
false;
false;
false;
false;
true;
true;
false;
true;
true;
false;
false;
true;
false;
false;
false;
true;
false;
false;
true;
false;
true;
false;
false;
true;
false;
false;
true;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
true;
false;
false;
false;
false;
true;
true;
false;
false;
false;
false;
true;
false;
false;
false;
true;
false;
true;
false;
true;
false;
false;
true;
false;
false;
true;
false;
false;
true;
false;
true;
true;
false;
false;
false;
true;
false;
false;
false;
false;
false;
false;
true;
false;
false;
false;
false;
true;
true;
true;
false;
false;
true;
false;
false;
false;
false;
false;
true;
false;
true;
true;
false;
false;
true;
false;
true;
true;
false;
false;
false;
false;
false;
false;
false;
false;
false;
false;
false;
true;
false;
true;
true;
false;
false;
false;
false;
false;
true;
true;
false;
true;
true;
true;
false;
false;
true;
false;
true;
false;
true;
false;
false;
true;
true;
false;
true;
false;
false;
true;
false;
false;
false]);
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114115_ft_rejectartifact_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114125_ft_timelockanalysis_output_timelock.mat' };
ft_timelockanalysis(cfg);

%%

cfg = [];
cfg.trials = logical([false;
false;
false;
true;
false;
false;
false;
true;
false;
true;
false;
true;
false;
false;
false;
false;
true;
true;
true;
false;
true;
false;
true;
false;
false;
true;
true;
false;
false;
true;
false;
false;
false;
false;
false;
true;
false;
true;
true;
false;
false;
false;
false;
true;
false;
false;
true;
false;
false;
true;
false;
true;
false;
false;
false;
true;
true;
false;
false;
true;
false;
false;
false;
false;
false;
false;
false;
true;
true;
false;
true;
false;
false;
false;
false;
false;
false;
true;
true;
true;
true;
false;
true;
false;
false;
false;
false;
true;
false;
false;
false;
false;
false;
false;
false;
true;
false;
true;
false;
true;
false;
false;
true;
false;
false;
true;
false;
false;
true;
false;
true;
false;
true;
false;
false;
false;
false;
true;
true;
false;
true;
true;
false;
true;
false;
false;
false;
false;
false;
true;
false;
false;
true;
true;
true;
false;
true;
true;
false;
false;
false;
false;
false;
true;
false;
false;
false;
false;
false;
false;
false;
true;
false;
false;
false;
false;
false;
false;
true;
true;
false;
true;
true;
false;
false;
false;
false;
false;
true;
false;
false;
false;
false;
true;
true;
true;
true;
false;
false;
true;
false;
true;
false;
false;
false;
true;
false;
false;
false;
false;
true;
false;
true;
false;
false;
false;
false;
true;
true;
false;
false;
false;
false;
true;
true;
true;
true;
false;
false;
true;
false;
true;
false;
false;
false;
false;
false;
false;
true;
false;
true;
false;
true;
false;
false;
true;
false;
false;
false;
false;
true;
false;
false;
false;
true;
false;
false;
true;
false;
false;
false;
false;
true;
false;
false;
true;
false;
false]);
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114115_ft_rejectartifact_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114129_ft_timelockanalysis_output_timelock.mat' };
ft_timelockanalysis(cfg);

%%

cfg = [];
cfg.showlabels = 'no';
cfg.fontsize = 6;
cfg.layout = 'CTF151_helmet.mat';
cfg.baseline = [-0.2 0];
cfg.xlim = [-0.2 1];
cfg.ylim = [-3e-13 3e-13];
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114125_ft_timelockanalysis_output_timelock.mat', 'reproduce_Subject04/20210112T114129_ft_timelockanalysis_output_timelock.mat', 'reproduce_Subject04/20210112T114121_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114138_ft_multiplotER_output';
figure; 
ft_multiplotER(cfg);

%%

cfg = [];
cfg.feedback = 'yes';
cfg.method = 'template';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114121_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114146_ft_prepare_neighbours_output_neighbours.mat' };
ft_prepare_neighbours(cfg);

%%

cfg = [];
cfg.feedback = 'yes';
cfg.method = 'template';
cfg.neighbours = 'reproduce_Subject04/20210112T114146_ft_prepare_neighbours_output_neighbours.mat';
cfg.planarmethod = 'sincos';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114121_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114149_ft_megplanar_output_data.mat' };
ft_megplanar(cfg);

%%

cfg = [];
cfg.feedback = 'yes';
cfg.method = 'template';
cfg.neighbours = 'reproduce_Subject04/20210112T114146_ft_prepare_neighbours_output_neighbours.mat';
cfg.planarmethod = 'sincos';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114125_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114152_ft_megplanar_output_data.mat' };
ft_megplanar(cfg);

%%

cfg = [];
cfg.feedback = 'yes';
cfg.method = 'template';
cfg.neighbours = 'reproduce_Subject04/20210112T114146_ft_prepare_neighbours_output_neighbours.mat';
cfg.planarmethod = 'sincos';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114129_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114155_ft_megplanar_output_data.mat' };
ft_megplanar(cfg);

%%

cfg = [];
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114149_ft_megplanar_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114159_ft_combineplanar_output_data.mat' };
ft_combineplanar(cfg);

%%

cfg = [];
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114152_ft_megplanar_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114202_ft_combineplanar_output_data.mat' };
ft_combineplanar(cfg);

%%

cfg = [];
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114155_ft_megplanar_output_data.mat' };
cfg.outputfile = { 'reproduce_Subject04/20210112T114206_ft_combineplanar_output_data.mat' };
ft_combineplanar(cfg);

%%

cfg = [];
cfg.xlim = [0.3 0.5];
cfg.zlim = 'maxmin';
cfg.colorbar = 'yes';
cfg.layout = 'CTF151_helmet.mat';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114121_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114209_ft_topoplotER_output';
figure; 
ft_topoplotER(cfg);

%%

cfg = [];
cfg.xlim = [0.3 0.5];
cfg.zlim = 'maxmin';
cfg.colorbar = 'yes';
cfg.layout = 'CTF151_helmet.mat';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114125_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114212_ft_topoplotER_output';
figure; 
ft_topoplotER(cfg);

%%

cfg = [];
cfg.xlim = [0.3 0.5];
cfg.zlim = 'maxmin';
cfg.colorbar = 'yes';
cfg.layout = 'CTF151_helmet.mat';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114129_ft_timelockanalysis_output_timelock.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114216_ft_topoplotER_output';
figure; 
ft_topoplotER(cfg);

%%

cfg = [];
cfg.xlim = [0.3 0.5];
cfg.zlim = 'maxabs';
cfg.colorbar = 'yes';
cfg.layout = 'CTF151_helmet.mat';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114159_ft_combineplanar_output_data.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114221_ft_topoplotER_output';
figure; 
ft_topoplotER(cfg);

%%

cfg = [];
cfg.xlim = [0.3 0.5];
cfg.zlim = 'maxabs';
cfg.colorbar = 'yes';
cfg.layout = 'CTF151_helmet.mat';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114202_ft_combineplanar_output_data.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114225_ft_topoplotER_output';
figure; 
ft_topoplotER(cfg);

%%

cfg = [];
cfg.xlim = [0.3 0.5];
cfg.zlim = 'maxabs';
cfg.colorbar = 'yes';
cfg.layout = 'CTF151_helmet.mat';
cfg.tracktimeinfo = 'yes';
cfg.trackmeminfo = 'yes';
cfg.inputfile = { 'reproduce_Subject04/20210112T114206_ft_combineplanar_output_data.mat' };
cfg.outputfile = 'reproduce_Subject04/20210112T114231_ft_topoplotER_output';
figure; 
ft_topoplotER(cfg);

